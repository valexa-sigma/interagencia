  CREATE TABLE "AGENCIA_USUARIO" 
   (	"ID_AGENCIA_USUARIO" NUMBER GENERATED BY DEFAULT ON NULL AS IDENTITY MINVALUE 1 MAXVALUE 9999999999999999999999999999 INCREMENT BY 1 START WITH 1 CACHE 20 NOORDER  NOCYCLE  NOKEEP  NOSCALE  NOT NULL ENABLE, 
	"ID_AGENCIA" NUMBER, 
	"ID_USUARIO" NUMBER, 
	"ENCARGADO" VARCHAR2(1), 
	"CBY" VARCHAR2(30), 
	"CDT" TIMESTAMP (6), 
	"MBY" VARCHAR2(30), 
	"MDT" TIMESTAMP (6), 
	"ACTIVO" VARCHAR2(1) DEFAULT 'Y', 
	 PRIMARY KEY ("ID_AGENCIA_USUARIO")
  USING INDEX  ENABLE, 
	 CONSTRAINT "AGENCIA_USUARIO_UK01" UNIQUE ("ID_AGENCIA", "ID_USUARIO")
  USING INDEX  ENABLE
   ) ;

  ALTER TABLE "AGENCIA_USUARIO" ADD CONSTRAINT "AGENCIA_USUARIO_FK01" FOREIGN KEY ("ID_AGENCIA")
	  REFERENCES "AGENCIA" ("ID_AGENCIA") ENABLE;
  ALTER TABLE "AGENCIA_USUARIO" ADD CONSTRAINT "AGENCIA_USUARIO_FK02" FOREIGN KEY ("ID_USUARIO")
	  REFERENCES "USUARIO" ("ID_USUARIO") ENABLE;

  CREATE OR REPLACE EDITIONABLE TRIGGER "TRG_AGENCIA_USUARIO_AUDIT" 
BEFORE INSERT OR UPDATE ON AGENCIA_USUARIO 
FOR EACH ROW 
BEGIN 
    :NEW.ACTIVO := NVL(:NEW.ACTIVO, 'Y');
    :NEW.MDT := SYSTIMESTAMP; 
    :NEW.MBY := NVL(v('APP_USER'), USER); 
    IF INSERTING THEN 
        :NEW.CDT := SYSTIMESTAMP; 
        :NEW.CBY := NVL(v('APP_USER'), USER); 
    END IF; 
END;
/
ALTER TRIGGER "TRG_AGENCIA_USUARIO_AUDIT" ENABLE;